<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.work.shop.dao.BgGoodsPropertyMapper">
  <resultMap id="goodsPropertyMap" type="com.work.shop.bean.GoodsProperty">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="goods_sn" property="goodsSn" jdbcType="VARCHAR" />
    <result column="goods_name" property="goodsName" jdbcType="VARCHAR" />
    <result column="cat_id" property="catId" jdbcType="INTEGER" />
    <result column="click_count" property="clickCount" jdbcType="INTEGER" />
    <result column="brand_code" property="brandCode" jdbcType="VARCHAR" />
    <result column="size_compare_code" property="sizeCompareCode" jdbcType="VARCHAR" />
    <result column="goods_weight" property="goodsWeight" jdbcType="DECIMAL" />
    <result column="market_price" property="marketPrice" jdbcType="DECIMAL" />
    <result column="protect_price" property="protectPrice" jdbcType="DECIMAL" />
    <result column="warn_number" property="warnNumber" jdbcType="INTEGER" />
    <result column="keywords" property="keywords" jdbcType="VARCHAR" />
    <result column="goods_brief" property="goodsBrief" jdbcType="VARCHAR" />
    <result column="goods_thumb" property="goodsThumb" jdbcType="VARCHAR" />
    <result column="goods_img" property="goodsImg" jdbcType="VARCHAR" />
    <result column="original_img" property="originalImg" jdbcType="VARCHAR" />
    <result column="is_real" property="isReal" jdbcType="TINYINT" />
    <result column="extension_code" property="extensionCode" jdbcType="VARCHAR" />
    <result column="season_code" property="seasonCode" jdbcType="VARCHAR" />
    <result column="series_code" property="seriesCode" jdbcType="VARCHAR" />
    <result column="depot_code" property="depotCode" jdbcType="VARCHAR" />
    <result column="seat_code" property="seatCode" jdbcType="VARCHAR" />
    <result column="integral" property="integral" jdbcType="INTEGER" />
    <result column="sort_order" property="sortOrder" jdbcType="INTEGER" />
    <result column="seller_note" property="sellerNote" jdbcType="VARCHAR" />
    <result column="give_integral" property="giveIntegral" jdbcType="INTEGER" />
    <result column="rank_integral" property="rankIntegral" jdbcType="INTEGER" />
    <result column="is_alone_sale" property="isAloneSale" jdbcType="BIT" />
    <result column="sales_type" property="salesType" jdbcType="TINYINT" />
    <result column="vedio_url" property="vedioUrl" jdbcType="VARCHAR" />
    <result column="material_code" property="materialCode" jdbcType="VARCHAR" />
    <result column="pur_price" property="purPrice" jdbcType="DECIMAL" />
    <result column="vedio_img_url" property="vedioImgUrl" jdbcType="VARCHAR" />
    <result column="goods_title" property="goodsTitle" jdbcType="VARCHAR" />
    <result column="sale_price" property="salePrice" jdbcType="DECIMAL" />
    <result column="is_on_sell" property="isOnSell" jdbcType="BIT" />
    <result column="is_new" property="isNew" jdbcType="BIT" />
    <result column="new_order" property="newOrder" jdbcType="INTEGER" />
    <result column="is_best" property="isBest" jdbcType="BIT" />
    <result column="best_order" property="bestOrder" jdbcType="INTEGER" />
    <result column="is_hot" property="isHot" jdbcType="BIT" />
    <result column="hot_order" property="hotOrder" jdbcType="INTEGER" />
    <result column="is_outlets" property="isOutlets" jdbcType="BIT" />
    <result column="outlets_count" property="outletsCount" jdbcType="REAL" />
    <result column="market_date" property="marketDate" jdbcType="DATE" />
    <result column="person_class" property="personClass" jdbcType="CHAR" />
    <result column="sale_count" property="saleCount" jdbcType="INTEGER" />
    <result column="fav_count" property="favCount" jdbcType="INTEGER" />
    <result column="like_count" property="likeCount" jdbcType="INTEGER" />
    <result column="unlike_count" property="unlikeCount" jdbcType="INTEGER" />
    <result column="cost_price" property="costPrice" jdbcType="DECIMAL" />
    <result column="thickness" property="thickness" jdbcType="VARCHAR" />
    <result column="elasticity" property="elasticity" jdbcType="VARCHAR" />
    <result column="softness" property="softness" jdbcType="VARCHAR" />
    <result column="palce_code" property="palceCode" jdbcType="VARCHAR" />
    <result column="size_picture" property="sizePicture" jdbcType="VARCHAR" />
    <result column="card_picture" property="cardPicture" jdbcType="VARCHAR" />
    <result column="size_table" property="sizeTable" jdbcType="VARCHAR" />
    <result column="collocation_goods_sn" property="collocationGoodsSn" jdbcType="VARCHAR" />
    <result column="sale_point" property="salePoint" jdbcType="LONGVARCHAR" />
    
    <result column="brand_name" jdbcType="VARCHAR" property="brandName" />
    <result column="cat_name" jdbcType="VARCHAR" property="catName" />
    <result column="channel_code" jdbcType="VARCHAR" property="channelCode" />
    <result column="shop_code" jdbcType="VARCHAR" property="shopCode" />
  </resultMap>
  
  
    <resultMap id="productShopMap" type="com.work.shop.bean.ProductGoodsVo">
      <result column="goods_sn" property="goodsSn" jdbcType="VARCHAR" />
      <result column="goods_name" property="goodsName" jdbcType="VARCHAR" />
      <result column="market_price" property="marketPrice" jdbcType="DECIMAL" />
      <result column="sale_price" property="salePrice" jdbcType="DECIMAL" />
      <result column="add_time" property="addTime" jdbcType="INTEGER" />
      <result column="last_update_time" property="lastUpdateTime" jdbcType="INTEGER" />
  </resultMap>
  
  <resultMap id="ColorAndSizeMap" type="com.work.shop.bean.ColorAndSize">
      <result column="color_code" property="colorCode" jdbcType="VARCHAR" />
      <result column="color_name" property="colorName" jdbcType="VARCHAR" />
      
         <result column="size_code" property="sizeCode" jdbcType="VARCHAR" />
      <result column="size_name" property="sizeName" jdbcType="VARCHAR" />
  </resultMap>

  <select id="selectGoodsProperties" parameterType="hashmap" resultMap="goodsPropertyMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
	SELECT
		#{channelCode} as channel_code,
		#{shopCode} as shop_code,
		plb.brand_name,
		pg.*,
		plc.cat_name
	FROM
		(
			SELECT
				*
			FROM
				product_goods
			WHERE
				goods_sn = #{goodsSn}
		) pg
	LEFT JOIN product_lib_category plc ON plc.cat_id = pg.cat_id
	LEFT JOIN product_lib_brand plb ON plb.brand_code = pg.brand_code;
  </select>
  
  
  <select id="selectDistinctColorAndSize" parameterType="hashmap" resultMap="ColorAndSizeMap">
  
  	SELECT DISTINCT ${colorCode} as color_Code,${colorName} as color_Name ,${sizeCode} as size_Code,${sizeName} as size_Name from product_barcode_list where 1=1 
  	 <if test="goodsSn != null">
        and goods_sn = ${goodsSn}
     </if>
  </select>
  
  
   <select id="selectProductGoods" parameterType="hashmap" resultMap="productShopMap">
  	 
   SELECT goods_sn,goods_name,sale_price,market_price,add_time,last_update_time from product_goods  where 1=1
  	 
  	 <if test="goodsSn != null">
        and goods_sn like '%${goodsSn}%'
     </if>
     
     <if test="goodsName != null">
        and goods_name like '%${goodsName}%'
     </if>
     
     <if test="channelCode != null">
        and channel_code like '%${channelCode}%'
     </if>
  	 LIMIT #{start},#{limit}
  </select>
  
    <resultMap id="ProductGoodsGalleryBaseResultMap" type="com.work.shop.bean.ProductGoodsGalleryVo">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="img_id" jdbcType="INTEGER" property="imgId" />
    <result column="goods_sn" jdbcType="VARCHAR" property="goodsSn" />
    <result column="img_url" jdbcType="VARCHAR" property="imgUrl" />
    <result column="img_desc" jdbcType="VARCHAR" property="imgDesc" />
    <result column="thumb_url" jdbcType="VARCHAR" property="thumbUrl" />
    <result column="img_original" jdbcType="VARCHAR" property="imgOriginal" />
    <result column="color_code" jdbcType="VARCHAR" property="colorCode" />
    <result column="type" jdbcType="INTEGER" property="type" />
    <result column="sort_order" jdbcType="INTEGER" property="sortOrder" />
    <result column="shop_code" jdbcType="INTEGER" property="shopCode" />
    <result column="channel_code" jdbcType="INTEGER" property="channelCode" />
  </resultMap>
  <select id="productGoodsGalleryList" parameterType="java.util.Map" resultMap="ProductGoodsGalleryBaseResultMap">
   
	SELECT DISTINCT
		#{channelCode} as channel_code,
		#{shopCode} as shop_code,
		pgg.goods_sn,
		pgg.img_url,
		IF ( pgg.img_desc IS NULL, pbl.color_name, pgg.img_desc) AS img_desc,
		pgg.thumb_url,
		pgg.img_original,
		pgg.color_code,
		pgg.type
	FROM
		product_goods_gallery pgg
	LEFT JOIN (
		SELECT DISTINCT
			color_name,
			color_code
		FROM
			product_barcode_list
		WHERE
			goods_sn = #{goodsSn}
	) pbl ON pgg.color_code = pbl.color_code
	WHERE 
		(pgg.type = 1 or pgg.type = 2 or pgg.type = 3 or pgg.type = 4)
		AND
		pgg.goods_sn = #{goodsSn}
	ORDER BY pgg.sort_order ASC
  </select>
  
  
  
  
</mapper>